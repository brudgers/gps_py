<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2017-02-17 Fri 14:25 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>General Problem Solver in Python</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="benrudgers" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">General Problem Solver in Python</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org9585247">Introduction</a>
<ul>
<li><a href="#org515eb33">So why Python?</a></li>
<li><a href="#org0aff5f7">General Approach</a></li>
</ul>
</li>
<li><a href="#orgb7676ca">Debugger</a>
<ul>
<li><a href="#orge9d2521">dbg ids</a></li>
<li><a href="#org69efdb8">dbg</a></li>
<li><a href="#org1be83e0">debug</a></li>
<li><a href="#org9527a9c">undebug</a></li>
<li><a href="#orgacc2434">debug indent</a></li>
</ul>
</li>
<li><a href="#org5becbbf">Utilities</a>
<ul>
<li><a href="#orgedd674e">cons</a></li>
<li><a href="#orgc097f5a">first</a></li>
<li><a href="#org2e801c9">rest</a></li>
<li><a href="#orga0857fe">list_append</a></li>
</ul>
</li>
<li><a href="#org1f7f637">General Problem Solver</a>
<ul>
<li><a href="#org0d5bb9f">Special Variables</a></li>
<li><a href="#org2ec8926">Data Structure</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-org9585247" class="outline-2">
<h2 id="org9585247">Introduction</h2>
<div class="outline-text-2" id="text-org9585247">
<p>
This is a 'port' of Norvig's General Problem Solver from Norvig's Common Lisp code to my own Python. While my intent with the exercise includes learning a bit more Python, the big goal is to ensure a better understanding of the General Problem Solver. Just as typing in code from a book creates deeper understanding than mere reading, I suspect that rewriting a program in a second language increases the understanding even more so&#x2026;yeah, it's a theory.
</p>
</div>

<div id="outline-container-org515eb33" class="outline-3">
<h3 id="org515eb33">So why Python?</h3>
<div class="outline-text-3" id="text-org515eb33">
<p>
Practically speaking, rewriting GPS in another Lisp (such as Clojure or Racket or Arc) smells a bit sour as an intellectual exercise. On the other hand, Norvig's handy <a href="http://norvig.com/python-lisp.html"><i>Python for Lisp Programmers</i></a> means there's an external basis for rewriting in Python and some signposts on how to proceed.
</p>
</div>
</div>

<div id="outline-container-org0aff5f7" class="outline-3">
<h3 id="org0aff5f7">General Approach</h3>
<div class="outline-text-3" id="text-org0aff5f7">
<p>
The primary goal is working code by porting the Common Lisp to Python. Isomorphism between the code bases may wind up being a stronger condiseration than idiomatic Python. There's always time for refactoring later. However, the code base will reflect Norvig's completed version of GPS rather than following the iterative process in his book.
</p>
</div>
</div>
</div>

<div id="outline-container-orgb7676ca" class="outline-2">
<h2 id="orgb7676ca">Debugger</h2>
<div class="outline-text-2" id="text-orgb7676ca">
<p>
One of the fun parts of Norvig's approach is building something rather than searching for someone else's tool. The simple debugger he implements for GPS seems like a good place to start.
</p>

<div class="org-src-container">
<pre class="src src-python" id="org4c26e2b"># This file autogenerated from gps_py.org

&lt;&lt;dbg_ids&gt;&gt;

&lt;&lt;dbg&gt;&gt;

&lt;&lt;debug&gt;&gt;

&lt;&lt;undebug&gt;&gt;

&lt;&lt;dbg_indent&gt;&gt;
</pre>
</div>
</div>

<div id="outline-container-orge9d2521" class="outline-3">
<h3 id="orge9d2521">dbg ids</h3>
<div class="outline-text-3" id="text-orge9d2521">
<p>
I used leading underscores to indicate there is something a bit special about the variable as an isomorphism to the asterisks in <code>*dbg-ids*</code> from Common Lisp.
</p>

<div class="org-src-container">
<pre class="src src-python" id="org4f4190f"># Identifiers used by dbg.
_dbg_ids_ = []
</pre>
</div>
</div>
</div>

<div id="outline-container-org69efdb8" class="outline-3">
<h3 id="org69efdb8">dbg</h3>
<div class="outline-text-3" id="text-org69efdb8">
<p>
Uses <code>target</code> instead of 'id'. May need to import <code>sys</code> and <code>write</code> to a different stream.
</p>
<div class="org-src-container">
<pre class="src src-python" id="orge6b346d">def dbg (target, format_string, *args):
    """Print debugging information if target has been specified"""
    if target in _dbg_ids_:
        print(format_string.format(args))
</pre>
</div>
</div>
</div>

<div id="outline-container-org1be83e0" class="outline-3">
<h3 id="org1be83e0">debug</h3>
<div class="outline-text-3" id="text-org1be83e0">
<div class="org-src-container">
<pre class="src src-python" id="orgb2462ca">def debug(*ids):
    """Start dbg output the given ids."""
    global _dbg_ids_
    _dbg_ids_ = _dbg_ids_ + list(ids)
</pre>
</div>
</div>
</div>

<div id="outline-container-org9527a9c" class="outline-3">
<h3 id="org9527a9c">undebug</h3>
<div class="outline-text-3" id="text-org9527a9c">
<p>
Python does not have set semantics for lists so I had to make <code>list_diff</code>, or rather I made <code>list_diff</code> so that <code>undebug</code> would have the appropriate level of abstraction. It seems to me that incorporating a list comprehension within <code>undebug</code> sort of gets in the way of readability&#x2026;particularly because the list comprehension contains a negative statement.
</p>

<p>
I used <code>minuend</code> and <code>subtrahend</code> per <a href="https://en.wikipedia.org/wiki/Subtraction">Wikipedia</a>.
</p>

<p>
Python requires the <code>global</code> keyword to perform the assignment to <code>_dbg_ids_</code> because the <code>=</code> operator makes the variable locally scoped.
</p>

<div class="org-src-container">
<pre class="src src-python" id="org08a9cfa">def list_diff(minuend, subtrahend):
    """Remove the elements of the subtrahend from the minuend."""
    return [val for val in minuend if val not in subtrahend]

def undebug(*ids):
    """Stop dbg on the ids. If no ids, stop all debugging"""
    global _dbg_ids_
    if ids:
        _dbg_ids_ = list_diff(_dbg_ids_, list(ids))
    else:
        _dbg_ids_ = []
</pre>
</div>
</div>
</div>

<div id="outline-container-orgacc2434" class="outline-3">
<h3 id="orgacc2434">debug indent</h3>
<div class="outline-text-3" id="text-orgacc2434">
<div class="org-src-container">
<pre class="src src-python" id="org6729454">def dbg_indent (target, indent, format_string, *args):
    """Print indented debugging info if target has been specified"""
    if target in _dbg_ids_:
        s = ""
        for i in range(indent):
            s += "    "
        s = s + format_string
        print(s.format(args))
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org5becbbf" class="outline-2">
<h2 id="org5becbbf">Utilities</h2>
<div class="outline-text-2" id="text-org5becbbf">
<p>
Since the first goal is to port code from Common Lisp it probably makes sense to have a some tools for handling lists in a familiar way. All of this can be refactored later.
</p>
</div>
<div id="outline-container-orgedd674e" class="outline-3">
<h3 id="orgedd674e">cons</h3>
<div class="outline-text-3" id="text-orgedd674e">
<p>
Where to start but with <code>cons</code>. It's not that Python doesn't have the ability to add to lists, it's just that trying to translate from front to rear addition is probably not the best place to start.
</p>
<div class="org-src-container">
<pre class="src src-python" id="orgc18a0b9">def cons (element, a_list):
    """
    Adds an elment to the *front* of a list.
    """
    a = [element]
    a.extend(a_list)
    return a
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc097f5a" class="outline-3">
<h3 id="orgc097f5a">first</h3>
<div class="outline-text-3" id="text-orgc097f5a">
<div class="org-src-container">
<pre class="src src-python" id="org5646177">def first(a_list):
    """
    Returns the first elment of a list.
    Returns False if the list is empty.
    """
    if len(a_list)==0:
        return False
    else:
        return a_list[0]
</pre>
</div>
</div>
</div>
<div id="outline-container-org2e801c9" class="outline-3">
<h3 id="org2e801c9">rest</h3>
<div class="outline-text-3" id="text-org2e801c9">
<div class="org-src-container">
<pre class="src src-python" id="org5fce81d">def rest(a_list):
    """
    Returns a list minus its first elment.
    Returns false if list is empty.
    Returns the empty list if list has one element.
    """
    if len(a_list)==0:
        return False
    elif len(a_list)==1:
        return []
    else:
        return a_list[1:]
</pre>
</div>
</div>
</div>
<div id="outline-container-orga0857fe" class="outline-3">
<h3 id="orga0857fe">list_append</h3>
<div class="outline-text-3" id="text-orga0857fe">
<p>
Python has an <code>append</code> function that adds an element onto the end of a list. While the <code>+</code> operator will concatenate two lists, my quick and dirty testing indicates it cannot be passed directly to <code>reduce</code>.
</p>
<pre class="example">
&gt;&gt;&gt; reduce(+, [[1],[2],[3]])
  File "&lt;stdin&gt;", line 1
    reduce(+, [[1],[2],[3]])
            ^
SyntaxError: invalid syntax
</pre>

<p>
The call to <code>+</code> must be wrapped in a <code>lambda</code>.
</p>
<div class="org-src-container">
<pre class="src src-python">reduce(lambda x,y: x + y, [[1],[2],[3]])
# =&gt; [1, 2, 3]
</pre>
</div>
<p>
This means that mapping an append operation starts to look like lambdas inside of lambdas and that smells to me like a breakdown of abstraction layers.
</p>
<div class="org-src-container">
<pre class="src src-python" id="org0b7aed5">def list_append(list_1, list_2):
    return list_1 + list_2
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org1f7f637" class="outline-2">
<h2 id="org1f7f637">General Problem Solver</h2>
<div class="outline-text-2" id="text-org1f7f637">
<p>
The outline for this Python implementation follows the structure of my Common Lisp implementation&#x2026;for better or worse.
</p>
<div class="org-src-container">
<pre class="src src-python" id="org29a58db"># This file autogenerated from gps_py.org

&lt;&lt;special-variables&gt;&gt;

&lt;&lt;op-data-structure&gt;&gt;
</pre>
</div>
</div>
<div id="outline-container-org0d5bb9f" class="outline-3">
<h3 id="org0d5bb9f">Special Variables</h3>
<div class="outline-text-3" id="text-org0d5bb9f">
<p>
The global variables follow the convention used by the debugger.
</p>
<div class="org-src-container">
<pre class="src src-python" id="orgdee2fa8">_ops_ = []
</pre>
</div>
</div>
</div>
<div id="outline-container-org2ec8926" class="outline-3">
<h3 id="org2ec8926">Data Structure</h3>
<div class="outline-text-3" id="text-org2ec8926">
<p>
An <code>op</code> has four fields. The Common Lisp implementation uses <code>defstruct</code>. There is not a clear equivalent data structure in Python. So here are a number of alternatives for representing the data structure. Dictionaries seemed like a reasonable alternative. But would require writing constructor functions to initialize the fields of dictionary objects. Named tuples seemed like another alternative and have the advantage of immutability. The probelm there is that using <code>my_tuple.replace(action</code>[spam, eggs])= when <code>my_tuple</code> is in a list of <code>namedtuple</code> requires pointer maintenance because Python lists are place based. Again there's book keeping.
</p>

<p>
So objects it is. 
</p>
<div class="org-src-container">
<pre class="src src-python" id="orgb7ed204">class Op:
    def __init__(self, action=[], preconds=[], add_list=[], del_list=[]):
        self.action = action
        self.preconds = preconds
        self.add_list = add_list
        self.del_list = del_list
    def __repr__(self):
        return str(vars(self))
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: benrudgers</p>
<p class="date">Created: 2017-02-17 Fri 14:25</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
